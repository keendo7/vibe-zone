<h3> Welcome <%= "#{current_user.first_name}" %>! </h3>
<%= render "posts/form" %>

<%= form_with(url: root_path, method: :get, data: {turbo_frame: "posts", turbo_action: "advance", controller: "search", action: "input->search#submit"}) do |form| %>
  <%= form.label :query, "Search" %>
  <%= form.text_field :query %>
  <%= form.submit 'Search' %>
<% end %>

<div data-controller="sort">
  <form method="get" action="<%= root_path %>" data-turbo-frame="posts" data-turbo-stream>
    <label for="sort_by">Sort by:</label>
    <select name="sort_by" data-action="sort#update" data-sort-target="select">
      <option value="newest" <%= 'selected' if params[:sort_by] == 'newest' %>>Newest</option>
      <option value="oldest" <%= 'selected' if params[:sort_by] == 'oldest' %>>Oldest</option>
      <option value="most_liked" <%= 'selected' if params[:sort_by] == 'most_liked' %>>Most liked</option>
      <option value="most_popular" <%= 'selected' if params[:sort_by] == 'most_popular' %>>Most popular</option>
    </select>
  </form>
</div>

<%= turbo_frame_tag :posts do %>
  <%== pagy_bootstrap_nav(@pagy) if @pagy.pages > 1 %>
  <%= render @posts %>
<% end %>
